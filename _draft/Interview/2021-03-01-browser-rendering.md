---
title: "Interview - 브라우저 렌더링 과정"
categories: 
  - interview
tags: 
    - 자바스크립트
    - 면접질문
    - 면접준비
    - 이직준비
toc: true
toc_sticky: true
comments:  true
---

## 브라우저란
웹 브라우저라고도 하며 그 종류로는 익스플로러, 엣지, 사파리, 크롬, 파이어폭스 등을 지칭합니다. 웹 브라우저란 웹 서버에서 쌍방향으로 통신하면서 html 문서나 파일을 출력하는 그래픽 사용자 인터페이스 기반의 응용소프트웨어 입니다.

## 웹 브라우저의 동작과정
브라우저는 사용자가 보고자 하는 화면에대해 서버에 요청하고 응답을 받아와 브라우저에 표시하게되는데 이때 html, css, javascript,  이미지 같은 파일들을 받아옵니다.
  
그리고 브라우저의 렌더링 엔진에 의해서 html 파서와 css 파서에 의해 트리형태로 구성되고 렌더트리로 다시 결합됩니다. 이렇게 생성된 렌더 트리를 기반으로 웹페이지에 그려지게 됩니다.
  
자바스크립트는 렌더링 엔진을 타는것이 아닌 별도의 자바스크립트엔진에 의해서 처리되는데 html 파서는 스크립트 태그를 만나게되면 자바스크립트 코드를 실행하기위해 돔 생성을 중단하고 자바스크립트 엔진에 권한을 넘깁니다. 자바스크립트의 실행이 끝나고나면 다시 돔으로 제어권을 넘겨 브라우저가 중단되었던 시점부터 다시 돔을 생성합니다.
  
렌더과정이 끝나게되면 레이아웃과정을 거치는데 이때 각 노드들은 주어진 좌표에 의해서 위치하게 됩니다.
  
이러한 동기적 동작방식때문에 일반적으로 스크립트 태그는 body 내의 가장 아래쪽에 위치시키는것이 돔의 렌더링 성능을 저하시키지않고 사용자 편의성을 높이는 방법으로 사용됩니다.  또한 돔이 완성되지않은 상태에서 자바스크립트가 돔을 조작하게된다면 에러가 발생하는것도 방지할 수 있습니다.
  
만약 스크립트를 상단에 사용하려면 자바스크립트내에서 돔의 렌더가 끝난후 동작하도록하는 로드이벤트를 활용하거나 스크립트의 속성중 defer 를 사용하여 html 돔트리 구성중 블로킹당하지 않도록 제어할 수 있습니다.

## 렌더링 최적화
레이아웃이나 이벤트의 변화에 따라서 레이아웃을 다시 그리는 리플로우단계가 반복적으로 발생할 수 있습니다. 
  
리플로우가 발생하는 경우는 다음과 같습니다.
- 페이지 초기렌더링
- 윈도우 리사이징
- 노드의 추가 또는 제거
- 요소의 위치 또는 크기 변경
- 폰트변경, 이미지 크기 변경

리플로우가 발생하면 그리는과정또한 뒤따르게 되는데 꼭 리플로우가 발생해야 리페인트가 발생하는건 아닙니다. 예를들어 배경색의 변경이나 visibility 속성같이 레이아웃에는 영향을 주지않을때에는 리페인트만 발생할 수 있습니다.
  
렌더링으 최적화는 바로 이 두가지를 최소한으로 줄이는데에 있습니다.
  
리플로우를 줄이는 방법에는 사이즈나 레이아웃의 위치 변경이 일어나는 속성들을 최소화 하는것입니다. 예를들면 positio 속성을 사용하여 top, left 등으로 위치를 잡는경우가 많은데 이것 대신에 transform 를 사용하는 방법이 있습니다.  
  
리페인트를 줄이는 방법에는 visibility / display 보다는 opacity 를 사용하는 방법이 있습니다.
  
이외에도 웹페이지에서 다운로드될 리소스를 줄이거나 js 나 css 파일을 minify 시켜 공백을 최소화하거나 웹팩을 사용하여 하나의 파일이나 또는 공통 파일끼리 번들링하는 방법이 있습니다.