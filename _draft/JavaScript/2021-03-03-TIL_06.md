---
title: "JavaScript 가비지 콜렉션"
categories: 
  - javascript
tags: 
    - 자바스크립트
    - 자바스크립트기본
    - 기본으로돌아가서
    - 가비지 콜렉션
    - 메모리 관리
toc: true
toc_sticky: true
comments:  true
---

## 가비지 콜렉션
자바스크립트는 실행환경에서 코드가 실행중에 주기적으로 메모리를 관리하는데 이것을 가비지 콜렉션이라고 부른다. 자바스크립트에서는 필요한 메모리를 자동으로 할당하고 사용되지 않는 메모리는 자동으로 회수되기때문에 개발자가 별도로 메모리 관리를 하지 않아도 된다. 
 
기본동작 방식은 이렇다. 더이상 사용되지않을 변수를 찾아내어 해당 변수가 차지하고있던 메모리를 회수한다.
```javascript
function a () {
    var num = 123
    return num;
}
a()
```
자바스크립트에서 함수는 한번 호출되면 실행되고서 소멸하게된다. 이때 내부에 있던 변수또한 소멸되는데 함수 내부에서 사용된 변수는 더이상 어딘가에서 도달할 수 없기때문에 메모리에서 제거된다. 

```javascript
function a () {
    var num = 123
    function b () {
        num = 333
    }
    return b
}
a();
```
만약 위와같이 클로저가 사용된경우에는 a 라는 외부함수는 한번실행되고 소멸하지만 아직 내부의 b 함수가 외부함수에서 갖고있던 상태 num 에대해서 참조하고있기때문에 이때는 메모리에서 제거되지않는다.
  
브라우저에 탑재되어있는 자바스크립트 실행 엔진에 따라서 이 가비지콜렉션의 동작방식이 약간씩 다를 수 있고 계속적으로 업데이트될 수 있는 사항이기도하다. 이 중 두가지 방법을 흔히 사용하는데 표시하고 지우기, 그리고 참조 카운팅이 있다. 이 둘중에서는 표시하고 지우기 (mark-and-sweep)방법이 가장 널리 사용되고 있다.

## 표시하고 지우기 (mark-and-sweep)
